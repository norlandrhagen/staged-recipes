"""Author: Norland Raphael Hagen - 08-03-2021
Pangeo-Forge recipe for E-OBS data (E-OBS: High-resolution gridded mean/max/min temperature, precipitation and sea level pressure for Europe & Northern Africa)"""  # noqa: E501


from pangeo_forge_recipes.patterns import ConcatDim, FilePattern, MergeDim
from pangeo_forge_recipes.recipes import XarrayZarrRecipe
import xarray as xr

# Filename Pattern Inputs
target_chunks = {"time": 40} 
dataset_version = "v23.1e"
grid_res = "0.1"
variables = ["tg", "tn", "tx", "rr", "pp", "hu", "fg", "qq"] #note: fg and qq are on differant grids
dataset_version = "v23.1e"
grid_res = "0.1"


# Note: _common_grid_lat and _common_grid_lon are the lat/lon coordinate values shared from six of the EOBS variables ("tg", "tn", "tx", "rr", "pp", "hu")
_common_grid_lat = [25.04986061012883,
 25.149860609811483,
 25.249860609494142,
 25.349860609176794,
 25.449860608859453,
 25.549860608542105,
 25.649860608224763,
 25.749860607907415,
 25.849860607590074,
 25.949860607272733,
 26.049860606955384,
 26.149860606638043,
 26.249860606320695,
 26.349860606003354,
 26.449860605686005,
 26.549860605368664,
 26.649860605051316,
 26.749860604733975,
 26.849860604416634,
 26.949860604099285,
 27.049860603781944,
 27.149860603464596,
 27.249860603147255,
 27.349860602829906,
 27.449860602512565,
 27.549860602195217,
 27.649860601877876,
 27.749860601560535,
 27.849860601243186,
 27.949860600925845,
 28.049860600608497,
 28.149860600291156,
 28.249860599973807,
 28.349860599656466,
 28.449860599339125,
 28.549860599021777,
 28.649860598704436,
 28.749860598387087,
 28.849860598069746,
 28.949860597752398,
 29.049860597435057,
 29.14986059711771,
 29.249860596800367,
 29.349860596483026,
 29.449860596165678,
 29.549860595848337,
 29.64986059553099,
 29.749860595213647,
 29.8498605948963,
 29.949860594578958,
 30.04986059426161,
 30.14986059394427,
 30.249860593626927,
 30.34986059330958,
 30.449860592992238,
 30.54986059267489,
 30.64986059235755,
 30.7498605920402,
 30.84986059172286,
 30.94986059140551,
 31.04986059108817,
 31.149860590770828,
 31.24986059045348,
 31.34986059013614,
 31.44986058981879,
 31.54986058950145,
 31.6498605891841,
 31.74986058886676,
 31.84986058854942,
 31.94986058823207,
 32.04986058791473,
 32.14986058759738,
 32.24986058728004,
 32.34986058696269,
 32.44986058664535,
 32.549860586328,
 32.64986058601066,
 32.74986058569332,
 32.84986058537597,
 32.94986058505863,
 33.04986058474128,
 33.14986058442394,
 33.24986058410659,
 33.34986058378925,
 33.4498605834719,
 33.54986058315456,
 33.64986058283722,
 33.74986058251987,
 33.84986058220253,
 33.94986058188518,
 34.04986058156784,
 34.14986058125049,
 34.24986058093315,
 34.349860580615804,
 34.44986058029846,
 34.54986057998112,
 34.64986057966377,
 34.74986057934643,
 34.849860579029084,
 34.94986057871174,
 35.049860578394394,
 35.14986057807705,
 35.24986057775971,
 35.349860577442364,
 35.44986057712502,
 35.549860576807674,
 35.64986057649033,
 35.749860576172985,
 35.849860575855644,
 35.949860575538295,
 36.049860575220954,
 36.14986057490361,
 36.249860574586265,
 36.349860574268924,
 36.449860573951575,
 36.549860573634234,
 36.649860573316886,
 36.749860572999545,
 36.849860572682196,
 36.949860572364855,
 37.049860572047514,
 37.149860571730166,
 37.249860571412825,
 37.349860571095476,
 37.449860570778135,
 37.54986057046079,
 37.649860570143446,
 37.7498605698261,
 37.849860569508756,
 37.949860569191415,
 38.04986056887407,
 38.149860568556726,
 38.24986056823938,
 38.349860567922036,
 38.44986056760469,
 38.54986056728735,
 38.649860566970005,
 38.74986056665266,
 38.849860566335316,
 38.94986056601797,
 39.04986056570063,
 39.14986056538328,
 39.24986056506594,
 39.34986056474859,
 39.44986056443125,
 39.5498605641139,
 39.64986056379656,
 39.74986056347922,
 39.84986056316187,
 39.94986056284453,
 40.049860562527186,
 40.14986056220984,
 40.24986056189249,
 40.34986056157515,
 40.44986056125781,
 40.54986056094046,
 40.64986056062311,
 40.74986056030577,
 40.84986055998843,
 40.94986055967108,
 41.04986055935374,
 41.1498605590364,
 41.24986055871905,
 41.3498605584017,
 41.44986055808436,
 41.54986055776702,
 41.64986055744967,
 41.74986055713233,
 41.84986055681499,
 41.94986055649764,
 42.04986055618029,
 42.14986055586295,
 42.24986055554561,
 42.34986055522826,
 42.44986055491091,
 42.54986055459358,
 42.64986055427623,
 42.74986055395888,
 42.84986055364154,
 42.9498605533242,
 43.04986055300685,
 43.1498605526895,
 43.24986055237216,
 43.34986055205482,
 43.44986055173747,
 43.54986055142013,
 43.64986055110279,
 43.74986055078544,
 43.849860550468094,
 43.94986055015075,
 44.04986054983341,
 44.14986054951606,
 44.24986054919872,
 44.34986054888138,
 44.44986054856403,
 44.549860548246684,
 44.64986054792934,
 44.749860547612,
 44.849860547294654,
 44.949860546977305,
 45.04986054665997,
 45.14986054634262,
 45.249860546025275,
 45.349860545707934,
 45.44986054539059,
 45.549860545073244,
 45.649860544755896,
 45.749860544438555,
 45.84986054412121,
 45.949860543803865,
 46.049860543486524,
 46.14986054316918,
 46.249860542851835,
 46.349860542534486,
 46.449860542217145,
 46.549860541899804,
 46.649860541582456,
 46.74986054126511,
 46.84986054094777,
 46.949860540630425,
 47.04986054031308,
 47.149860539995736,
 47.249860539678394,
 47.349860539361046,
 47.4498605390437,
 47.54986053872636,
 47.649860538409015,
 47.74986053809167,
 47.849860537774326,
 47.949860537456985,
 48.04986053713964,
 48.14986053682229,
 48.24986053650495,
 48.349860536187606,
 48.44986053587026,
 48.54986053555292,
 48.649860535235575,
 48.74986053491823,
 48.84986053460088,
 48.94986053428354,
 49.049860533966196,
 49.14986053364885,
 49.2498605333315,
 49.349860533014166,
 49.44986053269682,
 49.54986053237947,
 49.64986053206213,
 49.74986053174479,
 49.84986053142744,
 49.94986053111009,
 50.04986053079275,
 50.14986053047541,
 50.24986053015806,
 50.34986052984072,
 50.44986052952338,
 50.54986052920603,
 50.64986052888868,
 50.74986052857134,
 50.849860528254,
 50.94986052793665,
 51.04986052761931,
 51.14986052730197,
 51.24986052698462,
 51.34986052666727,
 51.44986052634993,
 51.54986052603259,
 51.64986052571524,
 51.74986052539789,
 51.84986052508055,
 51.94986052476321,
 52.04986052444586,
 52.14986052412852,
 52.24986052381118,
 52.34986052349383,
 52.44986052317648,
 52.54986052285914,
 52.6498605225418,
 52.74986052222445,
 52.84986052190711,
 52.94986052158977,
 53.04986052127242,
 53.14986052095507,
 53.24986052063773,
 53.34986052032039,
 53.44986052000304,
 53.549860519685694,
 53.64986051936836,
 53.74986051905101,
 53.849860518733664,
 53.94986051841632,
 54.04986051809898,
 54.14986051778163,
 54.249860517464285,
 54.34986051714694,
 54.4498605168296,
 54.549860516512254,
 54.64986051619491,
 54.74986051587757,
 54.84986051556022,
 54.949860515242875,
 55.049860514925534,
 55.14986051460819,
 55.249860514290845,
 55.3498605139735,
 55.44986051365616,
 55.549860513338814,
 55.649860513021466,
 55.749860512704124,
 55.84986051238678,
 55.949860512069435,
 56.049860511752094,
 56.149860511434746,
 56.249860511117404,
 56.349860510800056,
 56.449860510482715,
 56.549860510165374,
 56.649860509848025,
 56.74986050953068,
 56.849860509213336,
 56.949860508895995,
 57.04986050857865,
 57.149860508261305,
 57.249860507943964,
 57.349860507626616,
 57.44986050730927,
 57.54986050699193,
 57.649860506674585,
 57.74986050635724,
 57.849860506039896,
 57.94986050572255,
 58.049860505405206,
 58.14986050508786,
 58.24986050477052,
 58.349860504453176,
 58.44986050413583,
 58.549860503818486,
 58.64986050350114,
 58.7498605031838,
 58.84986050286645,
 58.94986050254911,
 59.049860502231766,
 59.14986050191442,
 59.24986050159707,
 59.34986050127973,
 59.44986050096239,
 59.54986050064504,
 59.6498605003277,
 59.74986050001035,
 59.84986049969301,
 59.94986049937566,
 60.04986049905832,
 60.14986049874098,
 60.24986049842363,
 60.34986049810629,
 60.44986049778894,
 60.5498604974716,
 60.64986049715425,
 60.74986049683691,
 60.84986049651957,
 60.94986049620222,
 61.04986049588488,
 61.14986049556753,
 61.24986049525019,
 61.34986049493284,
 61.4498604946155,
 61.54986049429816,
 61.64986049398081,
 61.74986049366346,
 61.84986049334612,
 61.94986049302878,
 62.04986049271143,
 62.14986049239409,
 62.24986049207674,
 62.3498604917594,
 62.44986049144205,
 62.54986049112471,
 62.64986049080737,
 62.74986049049002,
 62.84986049017268,
 62.94986048985533,
 63.04986048953799,
 63.14986048922064,
 63.2498604889033,
 63.34986048858596,
 63.44986048826861,
 63.54986048795127,
 63.64986048763392,
 63.74986048731658,
 63.84986048699923,
 63.94986048668189,
 64.04986048636455,
 64.1498604860472,
 64.24986048572985,
 64.3498604854125,
 64.44986048509517,
 64.54986048477782,
 64.64986048446048,
 64.74986048414314,
 64.8498604838258,
 64.94986048350844,
 65.04986048319111,
 65.14986048287376,
 65.24986048255641,
 65.34986048223907,
 65.44986048192173,
 65.54986048160438,
 65.64986048128704,
 65.74986048096969,
 65.84986048065235,
 65.949860480335,
 66.04986048001766,
 66.14986047970032,
 66.24986047938297,
 66.34986047906563,
 66.44986047874828,
 66.54986047843094,
 66.6498604781136,
 66.74986047779625,
 66.8498604774789,
 66.94986047716156,
 67.04986047684422,
 67.14986047652687,
 67.24986047620953,
 67.34986047589219,
 67.44986047557484,
 67.54986047525749,
 67.64986047494016,
 67.7498604746228,
 67.84986047430546,
 67.94986047398812,
 68.04986047367078,
 68.14986047335343,
 68.24986047303608,
 68.34986047271875,
 68.4498604724014,
 68.54986047208405,
 68.64986047176671,
 68.74986047144937,
 68.84986047113202,
 68.94986047081467,
 69.04986047049734,
 69.14986047017999,
 69.24986046986264,
 69.34986046954529,
 69.44986046922796,
 69.54986046891061,
 69.64986046859326,
 69.74986046827593,
 69.84986046795858,
 69.94986046764123,
 70.04986046732388,
 70.14986046700655,
 70.2498604666892,
 70.34986046637185,
 70.44986046605452,
 70.54986046573717,
 70.64986046541982,
 70.74986046510247,
 70.84986046478514,
 70.94986046446779,
 71.04986046415044,
 71.14986046383311,
 71.24986046351576,
 71.34986046319841,
 71.44986046288106]

_common_grid_lon = [-24.950139509199623,
 -24.850139509599675,
 -24.750139509999727,
 -24.65013951039978,
 -24.55013951079983,
 -24.450139511199882,
 -24.350139511599934,
 -24.250139511999983,
 -24.150139512400035,
 -24.050139512800087,
 -23.95013951320014,
 -23.85013951360019,
 -23.750139514000242,
 -23.65013951440029,
 -23.550139514800343,
 -23.450139515200394,
 -23.350139515600446,
 -23.250139516000498,
 -23.15013951640055,
 -23.0501395168006,
 -22.95013951720065,
 -22.850139517600702,
 -22.750139518000754,
 -22.650139518400806,
 -22.550139518800858,
 -22.45013951920091,
 -22.35013951960096,
 -22.25013952000101,
 -22.150139520401062,
 -22.050139520801114,
 -21.950139521201166,
 -21.850139521601218,
 -21.750139522001266,
 -21.650139522401318,
 -21.55013952280137,
 -21.450139523201422,
 -21.350139523601474,
 -21.250139524001526,
 -21.150139524401574,
 -21.050139524801626,
 -20.950139525201678,
 -20.85013952560173,
 -20.75013952600178,
 -20.650139526401833,
 -20.550139526801885,
 -20.450139527201934,
 -20.350139527601986,
 -20.250139528002038,
 -20.15013952840209,
 -20.05013952880214,
 -19.95013952920219,
 -19.850139529602245,
 -19.750139530002293,
 -19.650139530402345,
 -19.550139530802397,
 -19.45013953120245,
 -19.3501395316025,
 -19.25013953200255,
 -19.1501395324026,
 -19.050139532802653,
 -18.950139533202705,
 -18.850139533602757,
 -18.75013953400281,
 -18.65013953440286,
 -18.55013953480291,
 -18.45013953520296,
 -18.350139535603013,
 -18.250139536003065,
 -18.150139536403117,
 -18.05013953680317,
 -17.95013953720322,
 -17.85013953760327,
 -17.75013953800332,
 -17.650139538403373,
 -17.550139538803425,
 -17.450139539203477,
 -17.350139539603525,
 -17.25013954000358,
 -17.15013954040363,
 -17.05013954080368,
 -16.950139541203733,
 -16.850139541603784,
 -16.750139542003836,
 -16.650139542403885,
 -16.55013954280394,
 -16.45013954320399,
 -16.35013954360404,
 -16.250139544004092,
 -16.15013954440414,
 -16.050139544804196,
 -15.950139545204246,
 -15.850139545604296,
 -15.750139546004348,
 -15.6501395464044,
 -15.55013954680445,
 -15.450139547204502,
 -15.350139547604554,
 -15.250139548004606,
 -15.150139548404656,
 -15.050139548804708,
 -14.95013954920476,
 -14.85013954960481,
 -14.750139550004862,
 -14.650139550404914,
 -14.550139550804964,
 -14.450139551205016,
 -14.350139551605068,
 -14.250139552005118,
 -14.15013955240517,
 -14.050139552805222,
 -13.950139553205272,
 -13.850139553605324,
 -13.750139554005376,
 -13.650139554405428,
 -13.550139554805478,
 -13.45013955520553,
 -13.350139555605582,
 -13.250139556005632,
 -13.150139556405684,
 -13.050139556805735,
 -12.950139557205786,
 -12.850139557605837,
 -12.75013955800589,
 -12.65013955840594,
 -12.550139558805991,
 -12.450139559206043,
 -12.350139559606093,
 -12.250139560006145,
 -12.150139560406197,
 -12.05013956080625,
 -11.9501395612063,
 -11.850139561606351,
 -11.750139562006403,
 -11.650139562406453,
 -11.550139562806505,
 -11.450139563206557,
 -11.350139563606607,
 -11.250139564006659,
 -11.150139564406711,
 -11.050139564806761,
 -10.950139565206813,
 -10.850139565606865,
 -10.750139566006915,
 -10.650139566406967,
 -10.550139566807019,
 -10.45013956720707,
 -10.35013956760712,
 -10.250139568007173,
 -10.150139568407225,
 -10.050139568807275,
 -9.950139569207327,
 -9.850139569607379,
 -9.750139570007429,
 -9.65013957040748,
 -9.550139570807533,
 -9.450139571207583,
 -9.350139571607635,
 -9.250139572007686,
 -9.150139572407737,
 -9.050139572807788,
 -8.950139573207839,
 -8.85013957360789,
 -8.750139574007942,
 -8.650139574407994,
 -8.550139574808046,
 -8.450139575208098,
 -8.350139575608146,
 -8.250139576008198,
 -8.15013957640825,
 -8.050139576808302,
 -7.950139577208354,
 -7.850139577608406,
 -7.750139578008458,
 -7.650139578408506,
 -7.550139578808558,
 -7.45013957920861,
 -7.350139579608662,
 -7.250139580008714,
 -7.150139580408766,
 -7.050139580808814,
 -6.950139581208866,
 -6.850139581608918,
 -6.75013958200897,
 -6.650139582409022,
 -6.550139582809074,
 -6.4501395832091255,
 -6.350139583609174,
 -6.250139584009226,
 -6.150139584409278,
 -6.05013958480933,
 -5.9501395852093815,
 -5.850139585609433,
 -5.750139586009482,
 -5.650139586409534,
 -5.5501395868095855,
 -5.450139587209637,
 -5.350139587609689,
 -5.250139588009741,
 -5.15013958840979,
 -5.0501395888098415,
 -4.950139589209893,
 -4.850139589609945,
 -4.750139590009997,
 -4.650139590410049,
 -4.550139590810101,
 -4.450139591210149,
 -4.350139591610201,
 -4.250139592010253,
 -4.150139592410305,
 -4.050139592810357,
 -3.950139593210409,
 -3.850139593610457,
 -3.750139594010509,
 -3.650139594410561,
 -3.550139594810613,
 -3.450139595210665,
 -3.3501395956107167,
 -3.2501395960107686,
 -3.150139596410817,
 -3.050139596810869,
 -2.950139597210921,
 -2.8501395976109727,
 -2.7501395980110246,
 -2.6501395984110765,
 -2.550139598811125,
 -2.4501395992111767,
 -2.3501395996112286,
 -2.2501396000112805,
 -2.1501396004113325,
 -2.0501396008113844,
 -1.9501396012114327,
 -1.8501396016114846,
 -1.7501396020115365,
 -1.6501396024115884,
 -1.5501396028116403,
 -1.4501396032116922,
 -1.3501396036117441,
 -1.2501396040117925,
 -1.1501396044118444,
 -1.0501396048118963,
 -0.9501396052119482,
 -0.8501396056120001,
 -0.750139606012052,
 -0.6501396064121003,
 -0.5501396068121522,
 -0.45013960721220414,
 -0.35013960761225604,
 -0.25013960801230795,
 -0.15013960841235985,
 -0.05013960881241175,
 0.0498603907875399,
 0.149860390387488,
 0.2498603899874361,
 0.3498603895873842,
 0.4498603891873323,
 0.5498603887872804,
 0.649860388387232,
 0.7498603879871801,
 0.8498603875871282,
 0.9498603871870763,
 1.0498603867870244,
 1.1498603863869725,
 1.2498603859869242,
 1.3498603855868723,
 1.4498603851868204,
 1.5498603847867685,
 1.6498603843867166,
 1.7498603839866647,
 1.8498603835866128,
 1.9498603831865644,
 2.0498603827865125,
 2.1498603823864606,
 2.2498603819864087,
 2.349860381586357,
 2.449860381186305,
 2.5498603807862565,
 2.6498603803862046,
 2.7498603799861527,
 2.849860379586101,
 2.949860379186049,
 3.049860378785997,
 3.149860378385945,
 3.2498603779858968,
 3.349860377585845,
 3.449860377185793,
 3.549860376785741,
 3.649860376385689,
 3.7498603759856373,
 3.849860375585589,
 3.949860375185537,
 4.049860374785485,
 4.149860374385433,
 4.249860373985381,
 4.349860373585329,
 4.449860373185281,
 4.549860372785229,
 4.649860372385177,
 4.749860371985125,
 4.849860371585073,
 4.9498603711850215,
 5.04986037078497,
 5.149860370384921,
 5.249860369984869,
 5.3498603695848175,
 5.449860369184766,
 5.549860368784714,
 5.649860368384662,
 5.749860367984613,
 5.8498603675845615,
 5.94986036718451,
 6.049860366784458,
 6.149860366384406,
 6.249860365984354,
 6.349860365584302,
 6.449860365184254,
 6.549860364784202,
 6.64986036438415,
 6.749860363984098,
 6.849860363584046,
 6.949860363183994,
 7.049860362783942,
 7.149860362383894,
 7.249860361983838,
 7.34986036158379,
 7.449860361183742,
 7.549860360783686,
 7.649860360383638,
 7.7498603599835825,
 7.849860359583534,
 7.949860359183479,
 8.04986035878343,
 8.149860358383382,
 8.249860357983327,
 8.349860357583278,
 8.449860357183223,
 8.549860356783174,
 8.649860356383126,
 8.74986035598307,
 8.849860355583022,
 8.949860355182967,
 9.049860354782918,
 9.149860354382863,
 9.249860353982815,
 9.349860353582766,
 9.44986035318271,
 9.549860352782662,
 9.649860352382607,
 9.749860351982559,
 9.849860351582503,
 9.949860351182455,
 10.049860350782406,
 10.149860350382351,
 10.249860349982303,
 10.349860349582247,
 10.449860349182199,
 10.54986034878215,
 10.649860348382095,
 10.749860347982047,
 10.849860347581991,
 10.949860347181943,
 11.049860346781887,
 11.149860346381839,
 11.24986034598179,
 11.349860345581735,
 11.449860345181687,
 11.549860344781631,
 11.649860344381583,
 11.749860343981528,
 11.84986034358148,
 11.949860343181431,
 12.049860342781376,
 12.149860342381327,
 12.249860341981272,
 12.349860341581223,
 12.449860341181175,
 12.54986034078112,
 12.649860340381071,
 12.749860339981016,
 12.849860339580967,
 12.949860339180912,
 13.049860338780864,
 13.149860338380815,
 13.24986033798076,
 13.349860337580711,
 13.449860337180656,
 13.549860336780608,
 13.649860336380552,
 13.749860335980504,
 13.849860335580455,
 13.9498603351804,
 14.049860334780352,
 14.149860334380296,
 14.249860333980248,
 14.349860333580192,
 14.449860333180144,
 14.549860332780096,
 14.64986033238004,
 14.749860331979992,
 14.849860331579936,
 14.949860331179888,
 15.04986033077984,
 15.149860330379784,
 15.249860329979736,
 15.34986032957968,
 15.449860329179632,
 15.549860328779577,
 15.649860328379528,
 15.74986032797948,
 15.849860327579425,
 15.949860327179376,
 16.04986032677932,
 16.149860326379272,
 16.249860325979217,
 16.34986032557917,
 16.44986032517912,
 16.549860324779065,
 16.649860324379016,
 16.74986032397896,
 16.849860323578913,
 16.949860323178864,
 17.04986032277881,
 17.14986032237876,
 17.249860321978705,
 17.349860321578657,
 17.4498603211786,
 17.549860320778553,
 17.649860320378504,
 17.74986031997845,
 17.8498603195784,
 17.949860319178345,
 18.049860318778297,
 18.14986031837824,
 18.249860317978193,
 18.349860317578145,
 18.44986031717809,
 18.54986031677804,
 18.649860316377985,
 18.749860315977937,
 18.84986031557789,
 18.949860315177833,
 19.049860314777785,
 19.14986031437773,
 19.24986031397768,
 19.349860313577626,
 19.449860313177577,
 19.54986031277753,
 19.649860312377474,
 19.749860311977425,
 19.84986031157737,
 19.94986031117732,
 20.049860310777266,
 20.149860310377218,
 20.24986030997717,
 20.349860309577114,
 20.449860309177065,
 20.54986030877701,
 20.64986030837696,
 20.749860307976906,
 20.849860307576858,
 20.94986030717681,
 21.049860306776754,
 21.149860306376706,
 21.24986030597665,
 21.349860305576602,
 21.449860305176554,
 21.549860304776498,
 21.64986030437645,
 21.749860303976394,
 21.849860303576346,
 21.94986030317629,
 22.049860302776242,
 22.149860302376194,
 22.24986030197614,
 22.34986030157609,
 22.449860301176034,
 22.549860300775986,
 22.64986030037593,
 22.749860299975882,
 22.849860299575834,
 22.94986029917578,
 23.04986029877573,
 23.149860298375675,
 23.249860297975626,
 23.349860297575578,
 23.449860297175523,
 23.549860296775474,
 23.64986029637542,
 23.74986029597537,
 23.849860295575315,
 23.949860295175267,
 24.04986029477522,
 24.149860294375163,
 24.249860293975114,
 24.34986029357506,
 24.44986029317501,
 24.549860292774955,
 24.649860292374907,
 24.74986029197486,
 24.849860291574803,
 24.949860291174755,
 25.0498602907747,
 25.14986029037465,
 25.249860289974603,
 25.349860289574547,
 25.4498602891745,
 25.549860288774443,
 25.649860288374395,
 25.74986028797434,
 25.84986028757429,
 25.949860287174243,
 26.049860286774187,
 26.14986028637414,
 26.249860285974083,
 26.349860285574035,
 26.44986028517398,
 26.54986028477393,
 26.649860284373883,
 26.749860283973828,
 26.84986028357378,
 26.949860283173724,
 27.049860282773675,
 27.14986028237362,
 27.24986028197357,
 27.349860281573523,
 27.449860281173468,
 27.54986028077342,
 27.649860280373364,
 27.749860279973316,
 27.849860279573267,
 27.949860279173212,
 28.049860278773163,
 28.149860278373108,
 28.24986027797306,
 28.349860277573004,
 28.449860277172956,
 28.549860276772907,
 28.649860276372852,
 28.749860275972804,
 28.84986027557275,
 28.9498602751727,
 29.049860274772644,
 29.149860274372596,
 29.249860273972548,
 29.349860273572492,
 29.449860273172444,
 29.54986027277239,
 29.64986027237234,
 29.74986027197229,
 29.849860271572236,
 29.949860271172188,
 30.049860270772133,
 30.149860270372084,
 30.24986026997203,
 30.34986026957198,
 30.449860269171932,
 30.549860268771877,
 30.649860268371828,
 30.749860267971773,
 30.849860267571724,
 30.94986026717167,
 31.04986026677162,
 31.149860266371572,
 31.249860265971517,
 31.34986026557147,
 31.449860265171413,
 31.549860264771365,
 31.649860264371316,
 31.74986026397126,
 31.849860263571212,
 31.949860263171157,
 32.049860262771105,
 32.14986026237105,
 32.24986026197101,
 32.34986026157095,
 32.4498602611709,
 32.549860260770856,
 32.6498602603708,
 32.749860259970745,
 32.84986025957069,
 32.94986025917065,
 33.04986025877059,
 33.14986025837054,
 33.2498602579705,
 33.34986025757044,
 33.449860257170386,
 33.54986025677033,
 33.64986025637029,
 33.74986025597023,
 33.84986025557018,
 33.94986025517014,
 34.04986025477008,
 34.149860254370026,
 34.249860253969985,
 34.34986025356993,
 34.449860253169874,
 34.54986025276982,
 34.64986025236978,
 34.74986025196972,
 34.849860251569666,
 34.949860251169625,
 35.04986025076957,
 35.149860250369514,
 35.24986024996946,
 35.34986024956942,
 35.44986024916936,
 35.549860248769306,
 35.649860248369265,
 35.74986024796921,
 35.849860247569154,
 35.9498602471691,
 36.04986024676906,
 36.149860246369,
 36.24986024596895,
 36.349860245568905,
 36.44986024516885,
 36.549860244768794,
 36.64986024436874,
 36.7498602439687,
 36.84986024356864,
 36.94986024316859,
 37.049860242768546,
 37.14986024236849,
 37.249860241968435,
 37.34986024156838,
 37.44986024116834,
 37.54986024076828,
 37.64986024036823,
 37.749860239968186,
 37.84986023956813,
 37.949860239168075,
 38.049860238768034,
 38.14986023836798,
 38.24986023796792,
 38.34986023756787,
 38.449860237167826,
 38.54986023676777,
 38.649860236367715,
 38.749860235967674,
 38.84986023556762,
 38.94986023516756,
 39.04986023476752,
 39.149860234367466,
 39.24986023396741,
 39.34986023356737,
 39.449860233167314,
 39.54986023276726,
 39.6498602323672,
 39.74986023196716,
 39.849860231567106,
 39.94986023116705,
 40.04986023076701,
 40.149860230366954,
 40.2498602299669,
 40.34986022956684,
 40.4498602291668,
 40.54986022876675,
 40.64986022836669,
 40.74986022796665,
 40.849860227566595,
 40.94986022716654,
 41.049860226766484,
 41.14986022636644,
 41.24986022596639,
 41.34986022556633,
 41.44986022516629,
 41.549860224766235,
 41.64986022436618,
 41.749860223966124,
 41.84986022356608,
 41.94986022316603,
 42.04986022276597,
 42.14986022236593,
 42.249860221965875,
 42.34986022156582,
 42.449860221165764,
 42.54986022076572,
 42.64986022036567,
 42.74986021996561,
 42.84986021956557,
 42.949860219165515,
 43.04986021876546,
 43.149860218365404,
 43.24986021796536,
 43.34986021756531,
 43.44986021716525,
 43.54986021676521,
 43.649860216365155,
 43.7498602159651,
 43.84986021556506,
 43.949860215165,
 44.04986021476495,
 44.14986021436489,
 44.24986021396485,
 44.349860213564796,
 44.44986021316474,
 44.5498602127647,
 44.64986021236464,
 44.74986021196459,
 44.84986021156453,
 44.94986021116449,
 45.049860210764436,
 45.14986021036438,
 45.24986020996434,
 45.349860209564284,
 45.44986020916423]

def preproc(ds: xr.Dataset) -> xr.Dataset:
    """preprocessing function to reindex two variables to a common grid"""
    
    _common_date_range = xr.date_range(start='1950-01-01',end='1979-12-31',freq='1D')

    if list(ds.keys())[0] in ['fg']:
        # Processing Notes:
        # fg (wind_speed) only extends back to 1980. 
        # Empty dates from 1950 up to 1980 were prepended onto the dataset.

        _common_date_range = xr.date_range(start='1950-01-01',end='1979-12-31',freq='1D')
        missing_time_da = xr.DataArray(_common_date_range,dims=['time'])
        full_time = xr.concat([ds.time, missing_time_da], dim="time")
        ds = ds.reindex(time=full_time, fill_value=np.nan).sortby("time")

    if list(ds.keys())[0] in ['fg','qq']:
        # Processing Note:
        # Two variables in the EOBS dataset: fg (wind_speed) and qq (surface_downwelling_shortwave_flux_in_air) 
        # slightly differed in lat/lon values. These coordinates are reindex to the 'common grid' shared 
        # between the other six EOBS variables. 
        ds = ds.reindex({"latitude": _common_grid_lat, "longitude": _common_grid_lon},method='nearest')

    return ds

def make_filename(time: str, variable: str) -> str:
    return f"https://knmi-ecad-assets-prd.s3.amazonaws.com/ensembles/data/Grid_{grid_res}deg_reg_ensemble/{variable}_ens_mean_{grid_res}deg_reg_{dataset_version}.nc"  # noqa: E501


pattern = FilePattern(
    make_filename, ConcatDim("time", keys=[""]), MergeDim(name="variable", keys=variables)
)


recipe = XarrayZarrRecipe(
    file_pattern=pattern, target_chunks=target_chunks, process_chunk=preproc, subset_inputs={"time": 700}
)
